{
  "problem_name": "NS2D_FV_Implicit",
  "problem_id": "5",
  "problem_description": "Write a single, compilable C program that solves the 2D incompressible Navierâ€“Stokes equations in nondimensional form on the unit square using a strict Finite Volume Method (FVM) and PETSc's implicit time stepping.\n\nEquations:\nSolve for conservation of mass and momentum by summing fluxes over cell faces:\n$\\frac{d}{dt} (Vol \\cdot \\phi) + \\sum_{faces} (Flux_{conv} - Flux_{diff}) = S_{source}$\n\nSetup:\n- Domain: (0,1)x(0,1), structured Cartesian FV grid (Nx, Ny).\n- Time Interval: Integrate from t=0 to t=1.0.\n- Boundary conditions: Driven cavity (Top wall u=1, others 0).\n- Grid Arrangement: Staggered (MAC) grid. Pressure p at cell centers (i,j), horizontal velocity u at vertical faces (i+1/2, j), vertical velocity v at horizontal faces (i, j+1/2).\n\nRequirements:\n1. Discretization: Use a strict flux-based formulation on the staggered grid.\n   - Solve momentum equations on shifted control volumes centered around their respective velocity components (u-CVs and v-CVs).\n   - Solve the continuity equation on the pressure control volumes (main cells).\n   - Explicitly calculate convective and diffusive fluxes on the faces of these control volumes. \n2. Storage: Pack the unknowns (u, v, p) into a single PETSc global vector. Document your indexing scheme (e.g., DOF blocking or field blocking) clearly.\n3. Solver: Use fully implicit PETSc TS (e.g., TSSetIFunction and TSSetIJacobian) to solve the coupled nonlinear algebraic system.\n4. Implementation: Self-contained C file, no external dependencies.\n\nOutput:\nAt the end of the output, print a single line containing only a scalar measure of incompressibility--the maximum discrete divergence over all pressure cells. The line must contain only the numeric value (no words, labels, or extra characters).",
  "test_cases": [
    {
      "args": "-ts_type beuler",
      "expected_output": [2.91757e-11]
    }
  ]
}
